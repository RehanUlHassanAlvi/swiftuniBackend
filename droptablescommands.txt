-- Drop functions

DROP FUNCTION public.add_admin(varchar, varchar, varchar, int4, _varchar);
DROP FUNCTION public.add_admin_in_other(varchar, varchar, varchar, int4, _varchar);
DROP FUNCTION public.add_appeared_question(int4, timestamp, varchar, varchar, int4);
DROP FUNCTION public.add_attempted_question(int4, int4, float4, varchar, int4, bool);
DROP FUNCTION public.add_attempted_question_like(int4, int4);
DROP FUNCTION public.add_attempted_questions_comment(varchar, int4, int4);
DROP FUNCTION public.add_attempted_questions_comment_like(int4, int4);
DROP FUNCTION public.add_bookmark(int4, int4);
DROP FUNCTION public.add_comment(varchar, varchar, varchar, int4, int4, int4);
DROP FUNCTION public.add_comment_like(int4, int4);
DROP FUNCTION public.add_edit_test_question_note(int4, int4, varchar);
DROP FUNCTION public.add_mock_attempted_question(int4, int4, float4, varchar, int4, bool, int4, text, varchar);
DROP FUNCTION public.add_mock_attempted_question_timeout(int4, int4, bool, text);
DROP FUNCTION public.add_mock_test(varchar, int4, bool, int4);
DROP FUNCTION public.add_mock_test(varchar, int4, bool, int4, text);
DROP FUNCTION public.add_mock_test_questions(int4, _int4);
DROP FUNCTION public.add_option(varchar, varchar, int4, varchar);
DROP FUNCTION public.add_permissions_against_admin(_varchar, int4);
DROP FUNCTION public.add_portal(varchar, varchar, varchar);
DROP FUNCTION public.add_prediction_file(varchar, varchar, int4, bool);
DROP FUNCTION public.add_promo_code(int4, int4, int4, int4, int4, timestamp, varchar);
DROP FUNCTION public.add_question(varchar, varchar, int4, varchar, varchar, varchar, int4, varchar, bool);
DROP FUNCTION public.add_strategy_video(varchar, varchar, varchar, varchar, int4, varchar, bool, varchar, int4);
DROP FUNCTION public.add_student_by_admin(varchar, varchar, varchar, int4, varchar, varchar, varchar, varchar);
DROP FUNCTION public.add_subscription(varchar, varchar, int4, int4, varchar);
DROP FUNCTION public.add_template_grammar_pdf(varchar, varchar, bool, int4);
DROP FUNCTION public.add_test(int4, varchar, bool, int4, int4);
DROP FUNCTION public.add_test_category(varchar);
DROP FUNCTION public.add_test_questions(int4, _int4);
DROP FUNCTION public.add_user(varchar, varchar, varchar, varchar, varchar);
DROP FUNCTION public.add_user(varchar, varchar, varchar, varchar, varchar, int4);
DROP FUNCTION public.add_user_transaction(int4, varchar, varchar, varchar, varchar, varchar, varchar, varchar, bool, varchar, varchar, varchar, varchar, int4, varchar, varchar);
DROP FUNCTION public.add_user_transaction_alfalah(int4, varchar, varchar, varchar, varchar, varchar, int4, varchar, varchar, varchar, varchar, varchar, varchar, varchar);
DROP FUNCTION public.add_user_with_google(varchar, varchar, varchar, int4);
DROP FUNCTION public.add_user_with_google(varchar, varchar, varchar);
DROP FUNCTION public.add_vocab(varchar, varchar, int4, varchar);
DROP FUNCTION public.add_white_label_total_account(int4, varchar, int4, varchar);
DROP FUNCTION public.add_whitelabel_transaction(int4, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, int4, varchar, varchar, varchar);
DROP FUNCTION public.add_whitelabel_transaction_alfalah(int4, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, int4, varchar, varchar);
DROP FUNCTION public.approve_admin_transaction(varchar);
DROP FUNCTION public.approve_transaction(varchar);
DROP FUNCTION public.assign_account(int4, varchar, int4);
DROP FUNCTION public.authenticate_user_with_auth(varchar, varchar);
DROP FUNCTION public.authenticate_user_with_auth(varchar, varchar, int4);
DROP FUNCTION public.block_student_by_admin(int4);
DROP FUNCTION public.block_subscription_by_admin(varchar);
DROP FUNCTION public.check_admin(int4);
DROP FUNCTION public.check_admin_permission(int4, varchar);
DROP FUNCTION public.check_and_subtract_promocode_validity(varchar, int4);
DROP FUNCTION public.check_user(varchar);
DROP FUNCTION public.count_of_promocode_used(varchar);
DROP FUNCTION public.delete_admin(int4);
DROP FUNCTION public.delete_appeared_question(int4, int4);
DROP FUNCTION public.delete_attempted_question(int4);
DROP FUNCTION public.delete_attempted_question_like(int4, int4);
DROP FUNCTION public.delete_attempted_questions_comment(int4);
DROP FUNCTION public.delete_attempted_questions_comment_like(int4, int4);
DROP FUNCTION public.delete_bookmark(int4);
DROP FUNCTION public.delete_comment(int4);
DROP FUNCTION public.delete_comment_like(int4, int4);
DROP FUNCTION public.delete_mock_attempted_development(int4);
DROP FUNCTION public.delete_mock_test(int4);
DROP FUNCTION public.delete_mock_test_attempt(int4);
DROP FUNCTION public.delete_mock_test_questions_by_test_id(int4);
DROP FUNCTION public.delete_option(int4);
DROP FUNCTION public.delete_portal(int4);
DROP FUNCTION public.delete_prediction_file(int4);
DROP FUNCTION public.delete_question(int4);
DROP FUNCTION public.delete_strategy_video(int4);
DROP FUNCTION public.delete_subscription(varchar);
DROP FUNCTION public.delete_template_grammar_pdf(int4);
DROP FUNCTION public.delete_test(int4);
DROP FUNCTION public.delete_test_category(int4);
DROP FUNCTION public.delete_test_question_note_of_user(int4);
DROP FUNCTION public.delete_test_questions_by_test_id(int4);
DROP FUNCTION public.delete_user(int4, bool);
DROP FUNCTION public.delete_user_permanently(int4);
DROP FUNCTION public.delete_user_transaction(varchar);
DROP FUNCTION public.delete_vocab(int4);
DROP FUNCTION public.get_admin_transactions(int4);
DROP FUNCTION public.get_all_admins();
DROP FUNCTION public.get_all_categorized_tests();
DROP FUNCTION public.get_all_mock_tests(int4);
DROP FUNCTION public.get_all_mock_tests_for_user(int4, bool, int4);
DROP FUNCTION public.get_all_options();
DROP FUNCTION public.get_all_permissions();
DROP FUNCTION public.get_all_portal_admins(int4);
DROP FUNCTION public.get_all_portals();
DROP FUNCTION public.get_all_prediction_files(bool);
DROP FUNCTION public.get_all_promo_codes();
DROP FUNCTION public.get_all_questions(int4, int4);
DROP FUNCTION public.get_all_strategy_videos(bool);
DROP FUNCTION public.get_all_students_by_super_admin(int4, varchar, bool, varchar);
DROP FUNCTION public.get_all_subscriptions();
DROP FUNCTION public.get_all_templates(bool);
DROP FUNCTION public.get_all_templates_of_portal(bool, int4);
DROP FUNCTION public.get_all_test_categories();
DROP FUNCTION public.get_all_tests();
DROP FUNCTION public.get_all_user_transactions(int4, int4, bool, varchar);
DROP FUNCTION public.get_all_users();
DROP FUNCTION public.get_all_vocabs(int4);
DROP FUNCTION public.get_all_white_label_total_accounts(int4);
DROP FUNCTION public.get_all_whitelabel_transactions(int4, int4, bool, varchar);
DROP FUNCTION public.get_analytics_of_mock_test(int4);
DROP FUNCTION public.get_appeared_question(int4, int4);
DROP FUNCTION public.get_attempted_mock_tests(int4);
DROP FUNCTION public.get_attempted_question(int4);
DROP FUNCTION public.get_attempted_questions_by_question_id(int4, int4, int4, int4, bool);
DROP FUNCTION public.get_attempted_questions_of_others_by_question_id(int4, int4, int4, int4, bool);
DROP FUNCTION public.get_comments(int4, int4);
DROP FUNCTION public.get_deleted_users();
DROP FUNCTION public.get_mock_test_questions_by_test_id(int4, int4);
DROP FUNCTION public.get_mock_test_questions_by_test_id_for_admin(int4);
DROP FUNCTION public.get_mock_test_questions_if_pending(int4, int4);
DROP FUNCTION public.get_mock_test_user_attempted_count(int4, bool);
DROP FUNCTION public.get_plans_with_subplans();
DROP FUNCTION public.get_plans_with_subplans_mockonly();
DROP FUNCTION public.get_portal_configuration(int4);
DROP FUNCTION public.get_portal_info(varchar, bool);
DROP FUNCTION public.get_portal_info_by_id(int4);
DROP FUNCTION public.get_portal_info_for_users(varchar);
DROP FUNCTION public.get_portal_transactions(int4, varchar);
DROP FUNCTION public.get_promo_code_by_id(varchar);
DROP FUNCTION public.get_promo_code_by_id_for_user(varchar, int4);
DROP FUNCTION public.get_promo_code_by_id_for_whitelabel_admin(varchar, int4);
DROP FUNCTION public.get_question_with_options(int4, int4, int4);
DROP FUNCTION public.get_question_with_options_for_admin(int4, int4);
DROP FUNCTION public.get_question_with_options_for_mock(int4);
DROP FUNCTION public.get_remaining_free_tokens(int4);
DROP FUNCTION public.get_score_of_mock_test(int4);
DROP FUNCTION public.get_strategy_video_of_portal(bool, int4);
DROP FUNCTION public.get_student_by_admin(int4, varchar, bool, varchar);
DROP FUNCTION public.get_student_data(int4);
DROP FUNCTION public.get_student_from_trash_by_admin(int4, varchar, bool, varchar);
DROP FUNCTION public.get_test_categories_with_tests();
DROP FUNCTION public.get_test_question_note_of_user(int4, int4);
DROP FUNCTION public.get_test_questions_by_test_id(int4, int4, int4);
DROP FUNCTION public.get_test_questions_by_test_name(varchar, int4, int4, int4);
DROP FUNCTION public.get_test_questions_of_user_by_test_id(int4, int4, int4, int4, varchar);
DROP FUNCTION public.get_test_questions_of_user_by_test_name(varchar, int4, int4, int4, bool, varchar, varchar, bool, bool, varchar, bool, bool);
DROP FUNCTION public.get_test_questions_of_user_by_test_name(varchar, int4, int4, int4, bool, varchar, varchar, bool, bool);
DROP FUNCTION public.get_test_questions_of_user_by_test_name_for_admin(varchar, int4, int4, bool, varchar, varchar, bool, bool);
DROP FUNCTION public.get_transaction_details();
DROP FUNCTION public.get_user_exam_date(int4);
DROP FUNCTION public.get_user_stored_analysis(int4, bool);
DROP FUNCTION public.get_user_transactions(int4, varchar);
DROP FUNCTION public.login_admin(varchar, varchar);
DROP FUNCTION public.login_admin(varchar, varchar, int4);
DROP FUNCTION public.login_user(varchar, varchar);
DROP FUNCTION public.login_user(varchar, varchar, int4, varchar, timestamptz);
DROP FUNCTION public.logout_user_by_admin(int4);
DROP FUNCTION public.remove_student_from_trash_by_admin(int4);
DROP FUNCTION public.reset_mock_attempts_of_user(int4);
DROP FUNCTION public.reset_password(varchar, varchar);
DROP FUNCTION public.reset_user_free_tokens();
DROP FUNCTION public.subtract_free_tokens(int4, varchar);
DROP FUNCTION public.superadmin_buy(int4, varchar, varchar, int4, text);
DROP FUNCTION public.superadmin_buy_subscription_for_user(varchar, int4, text);
DROP FUNCTION public.toggle_promo_code_status(varchar);
DROP FUNCTION public.unsubscribe_user_on_timeend();
DROP FUNCTION public.update_admin(int4, varchar, varchar);
DROP FUNCTION public.update_mock_test(int4, varchar, int4, bool, text);
DROP FUNCTION public.update_mock_test_attempt(int4, timestamp);
DROP FUNCTION public.update_option(int4, varchar, varchar, int4, varchar);
DROP FUNCTION public.update_order_id_mock_test_questions(int4, int4);
DROP FUNCTION public.update_order_id_mock_tests(int4, int4);
DROP FUNCTION public.update_order_id_test_category(int4, int4);
DROP FUNCTION public.update_order_id_test_questions(int4, int4);
DROP FUNCTION public.update_order_id_tests(int4, int4);
DROP FUNCTION public.update_portal(int4, varchar, varchar);
DROP FUNCTION public.update_portal_configuration(int4, bool, bool, bool, bool, bool, bool);
DROP FUNCTION public.update_portal_info(int4, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar, varchar);
DROP FUNCTION public.update_prediction_file(int4, varchar, varchar, int4, bool);
DROP FUNCTION public.update_question(int4, varchar, varchar, int4, varchar, varchar, varchar, int4, varchar, bool);
DROP FUNCTION public.update_question_prediction(int4);
DROP FUNCTION public.update_strategy_video(int4, varchar, varchar, varchar, varchar, int4, varchar, bool, varchar, int4);
DROP FUNCTION public.update_student(int4, varchar, varchar, varchar, varchar, varchar, varchar);
DROP FUNCTION public.update_subscription(varchar, varchar, varchar, int4, int4, varchar);
DROP FUNCTION public.update_template(int4, varchar, varchar, bool, int4);
DROP FUNCTION public.update_test(int4, int4, varchar, bool, int4, int4);
DROP FUNCTION public.update_test_category(int4, varchar);
DROP FUNCTION public.update_transaction_details_super_admin(text);
DROP FUNCTION public.update_user(int4, varchar, varchar, varchar, varchar, varchar);
DROP FUNCTION public.update_user_analysis_in_user(int4, jsonb, bool);
DROP FUNCTION public.update_user_exam_date(int4, timestamp, text);
DROP FUNCTION public.update_user_transaction(varchar, int4, int4, varchar, varchar, varchar, varchar);
DROP FUNCTION public.update_vocab(int4, varchar);
DROP FUNCTION public.user_analysis(int4, bool);
DROP FUNCTION public.verify_email(varchar);



-- Drop tables with most dependencies first
DROP TABLE IF EXISTS public.mock_attempted_questions;
DROP TABLE IF EXISTS public.comment_likes;
DROP TABLE IF EXISTS public.attempted_questions_comment_likes;
DROP TABLE IF EXISTS public.white_label_total_accounts;
DROP TABLE IF EXISTS public.test_question_notes;
DROP TABLE IF EXISTS public.options;
DROP TABLE IF EXISTS public.mock_test_questions;
DROP TABLE IF EXISTS public.comments;
DROP TABLE IF EXISTS public.bookmarks;
DROP TABLE IF EXISTS public.attempted_questions_likes;
DROP TABLE IF EXISTS public.attempted_questions_comments;
DROP TABLE IF EXISTS public.attempted_questions;
DROP TABLE IF EXISTS public.appeared_questions;
DROP TABLE IF EXISTS public.whitelabel_transactions;
DROP TABLE IF EXISTS public.user_transactions;
DROP TABLE IF EXISTS public.test_questions;
DROP TABLE IF EXISTS public.question;
DROP TABLE IF EXISTS public.mock_test_attempts;
DROP TABLE IF EXISTS public.vocab_bank;
DROP TABLE IF EXISTS public.promo_codes;  -- Moved before users
DROP TABLE IF EXISTS public.users;
DROP TABLE IF EXISTS public.templates_and_grammar_pdfs;
DROP TABLE IF EXISTS public.strategy_video;
DROP TABLE IF EXISTS public.permissions_admin;
DROP TABLE IF EXISTS public.permissions;
DROP TABLE IF EXISTS public.mock_test;
DROP TABLE IF EXISTS public.bridge_paln_subplans;
DROP TABLE IF EXISTS public.admins;
DROP TABLE IF EXISTS public.test;

-- Drop base/lookup tables last
DROP TABLE IF EXISTS public.test_categories;
DROP TABLE IF EXISTS public.subscriptions;
DROP TABLE IF EXISTS public.subplans_for_whitelabels;
DROP TABLE IF EXISTS public.prediction_file;
DROP TABLE IF EXISTS public.portal;
DROP TABLE IF EXISTS public.plans_for_whitelabels;
DROP TABLE IF EXISTS public.permission_sub_types;
DROP TABLE IF EXISTS public.permission_main_type;
DROP TABLE IF EXISTS public.mock_test_types;
DROP TABLE IF EXISTS public.mock_test_id_;

--Drop generate random string function
DROP FUNCTION public.generate_random_string(int4);


-- Drop sequences
DROP SEQUENCE IF EXISTS public.admins_id_seq;
DROP SEQUENCE IF EXISTS public.appeared_questions_id_seq;
DROP SEQUENCE IF EXISTS public.attempted_questions_comment_likes_id_seq;
DROP SEQUENCE IF EXISTS public.attempted_questions_comments_id_seq;
DROP SEQUENCE IF EXISTS public.attempted_questions_id_seq;
DROP SEQUENCE IF EXISTS public.attempted_questions_likes_id_seq;
DROP SEQUENCE IF EXISTS public.bookmarks_id_seq;
DROP SEQUENCE IF EXISTS public.comment_likes_id_seq;
DROP SEQUENCE IF EXISTS public.comments_id_seq;
DROP SEQUENCE IF EXISTS public.mock_attempted_questions_id_seq;
DROP SEQUENCE IF EXISTS public.mock_test_attempts_id_seq;
DROP SEQUENCE IF EXISTS public.mock_test_id_seq;
DROP SEQUENCE IF EXISTS public.mock_test_questions_id_seq;
DROP SEQUENCE IF EXISTS public.mock_test_types_id_seq;
DROP SEQUENCE IF EXISTS public.options_id_seq;
DROP SEQUENCE IF EXISTS public.permission_main_type_id_seq;
DROP SEQUENCE IF EXISTS public.permission_sub_types_id_seq;
DROP SEQUENCE IF EXISTS public.permissions_admin_id_seq;
DROP SEQUENCE IF EXISTS public.permissions_id_seq;
DROP SEQUENCE IF EXISTS public.permissions_old_id_seq;
DROP SEQUENCE IF EXISTS public.portal_id_seq;
DROP SEQUENCE IF EXISTS public.prediction_file_id_seq;
DROP SEQUENCE IF EXISTS public.question_id_seq;
DROP SEQUENCE IF EXISTS public.strategy_video_id_seq;
DROP SEQUENCE IF EXISTS public.templates_and_grammar_pdfs_id_seq;
DROP SEQUENCE IF EXISTS public.test_categories_id_seq;
DROP SEQUENCE IF EXISTS public.test_id_seq;
DROP SEQUENCE IF EXISTS public.test_question_notes_id_seq;
DROP SEQUENCE IF EXISTS public.test_questions_id_seq;
DROP SEQUENCE IF EXISTS public.users_id_seq;
DROP SEQUENCE IF EXISTS public.vocab_bank_id_seq;
DROP SEQUENCE IF EXISTS public.white_label_total_accounts_id_seq;
